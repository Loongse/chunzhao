# 文件管理

1. 文件中的数据是怎样被组织起来的？

   1. 文件分为有结构文件（重点）和无结构文件（有一些列的二进制和字符流组成）。

2. 操作系统应该向上提供哪些功能？

   1. 可以创建文件、（create系统调用）
   2. 可以读文件，read系统调用
   3. 可以写文件，write系统调用
   4. 可以删除文件，delete系统调用
   5. 打开文件，open系统调用
   6. 关闭文件，close系统调用

   可以用几个基本操作完成更复杂的操作比如说复制，就是先创建一个新的空文件夹，再把源文件读入内存如何再把内存中的数据写入新文件中。

3. 从上向下看，文件应该如何存放在外存？

   1. 与内存类似，由一个个存储单元组成，每个存储单元可以存储一定量的数据，每个存储单元对应一个物理地址。

![](img\初始文件管理.png)

## 文件的逻辑结构

文件的逻辑结构就是在用户看来，文件内部的数据应该是如何组织起来的。而物理结构就是在操作系统看来，文件中的数据是如何存放在外存中的。

### 无结构文件

文件的内部是一系列的二进制或者字符流组成，又称**流式文件。**比如txt文件

### 有结构文件

由一组相似的记录组成，又称**记录式文件**，每条记录又有若干个数据项组成。根据各条记录的长度是否相等，又可以**分为定长记录和可变长记录两种**。

#### 顺序文件

文件中的记录一个接一个的顺序排列（逻辑上），记录可以是**定长或者可变长的**。各个记录在物理上可以**顺序存储（逻辑与物理都连续）或者链式存储（逻辑连续的物理不一定连续）。**

![](img\顺序文件.png)



#### 索引文件

索引表本身是一个定长的顺序文件，因此可以快速随机访问对应的索引项。

主要用于对**信息处理的及时性要求比较高的场合**，**对于不同的数据可以用不同的索引表。**

#### **索引顺序文件**

索引顺序文件是索引文件和顺序文件思想的结合，索引顺序文件中，同样会为文件建立一张索引表，但是不同的是：并不是每个记录对应一个索引表，而**是一组记录对应一个索引表项。**

问题：能否解决不定长记录的顺序文件检索速度慢的问题？

为了进一步提高检索效率，可以为顺序文件**建立多级索引表。**

![](img\有结构文件.png)





## 文件的物理结构（文件分配方式）

1. 对非空闲磁盘块的管理
2. 对空闲磁盘块的管理

文件数据应该怎么存放在外存中？

### 连续分配

### 链接分配

#### 隐式链接

#### 显示链接

### 索引分配



## 文件共享

1. 基于索引结点的共享方式（硬链接）

   ![](img\硬链接说明.png)

2. 基于符号链的共享方式（软链接）

   ![](img\软连接.png)

   

   







