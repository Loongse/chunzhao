# 操作系统的运行机制和体系结构

![image-20210221165933789](D:\2021\chunzhao\OS\img\操作系统的运行机制和体系结构.png)

首先，指令就是CPU能够识别执行的基本命令。

指令分为特权指令以及非特权指令，特权指令有内存清零指令，而非特权指令包括典型的运算指令，特权指令不允许用户程序使用。

两种处理器状态分别为用户态和核心态，用户态的CPU只能执行非特权指令，而核心态都可以执行。PSW程序状态字寄存器中的标志位来标识是什么状态。

两种程序包括内核程序以及应用程序，操作系统的内核程序时系统的管理者，既可以执行特权指令也可以执行非特权指令，运行在核心态，为了保证系统的安全运行，普通的应用程序只能执行非特权指令运行在用户态。

操作系统中的哪些功能应该在内核程序实现：比如时钟管理、中断处理、原语以及进程、存储器、设备管理。

下面是计算机系统的层次结构：
![](D:\2021\chunzhao\OS\img\操作系统层次结构.png)

微内核指的是时钟管理、中断处理这些，而大内核则包含了设备、进程、存储器管理等功能。

- 大内核：
  - 将操作系统的**主要功能模块都作为系统内核运行在核心态**
  - 优点：高性能
  - 缺点：内核代码庞大，结构混乱、难以维护
- 微内核：
  - 只把基本的功能保留在内核
  - 优点：内核功能少，结构清晰，方便维护
  - 缺点：需要频繁的在核心态与用户态之间进行切换，性能低

